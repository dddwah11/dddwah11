
<!DOCTYPE html>
<html lang="en ">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>61分 || </title>
    <meta name="author" content="小刘">
    <meta name="description" content=" ">
    <meta name="keywords" content=" ">
    <link rel="icon" href="/images/src.jpeg">
    <link rel="stylesheet" href="/css/antd.min.css">
    
    <link rel="stylesheet" href="/css/full-theme.css">
    
    <script src="/js/vue.js"></script>
    <script src="/js/antd.min.js"></script>
<meta name="generator" content="Hexo 6.1.0"></head>

<body>

    <div id="loading"
        style="height: 100vh; width: 100%; position: fixed;display: flex;z-index: 200; justify-content: space-between;">
        <div id="loadleft" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div id="loadright" style="width: 50%;background-color: #ffffff;transition: width 0.6s ease-out;"></div>
        <div
            style="position: fixed; height: 100vh; width: 100%;display: flex;justify-content: center;align-items: center;">
            <div id="loadcontent"
                style="width:400px;height:400px;padding:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;border:solid 10px#a3ddfb; text-align:center;opacity:1;transition:opacity 0.3s ease-out;">
                <div>
                    <h2>LOADING...</h2>
                    <p>加载过慢请开启缓存(浏览器默认开启)</p>
                    <div>
                        <img src="/dancingkitty.gif" alt="loading">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="layout">
        <transition name="into">
            <div v-show="show_page" style="display: none;">
                <div id="menu_show">
                     
<nav id="menu">
    <div class="desktop-menu">
        <a href="/">
            <span class="title">61分</span>
        </a>
        
        <a href="/">
            <span>
                <a-icon type="home" theme="filled" />
            </span>
            <span>首页</span>
        </a>
        
        <a href="/about">
            <span>
                <a-icon type="about" theme="filled" />
            </span>
            <span>关于</span>
        </a>
        
        <a href="/archives">
            <span>
                <a-icon type="archives" theme="filled" />
            </span>
            <span>文档</span>
        </a>
        
        <a href="/like/categories">
            <span>
                <a-icon type="categories" theme="filled" />
            </span>
            <span>类别</span>
        </a>
        
        <a href="/like/tags">
            <span>
                <a-icon type="tags" theme="filled" />
            </span>
            <span>标签</span>
        </a>
        
    </div>

    <div :class="'phone-menu ' + menu_show" id="phone-menu">
        <div :class="'title'" @click="menu_show=!menu_show">
            <span style="margin-right: 10px;">
                <a-icon type="appstore" theme="filled" />
            </span>
            <span>61分</span>
        </div>
        <div class="items" v-show="menu_show">
            
            <a href="/">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="home" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">首页</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="about" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">关于</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="archives" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">文档</div>
                </div>
            </a>
            
            <a href="/like/categories">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="categories" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">类别</div>
                </div>
            </a>
            
            <a href="/like/tags">
                <div class="item">
                    <div style="min-width:20px; max-width:50px; width: 10%">
                        <a-icon type="tags" theme="filled" />
                    </div>
                    <div style="min-width:100px;max-width: 150%;width: 20%;">标签</div>
                </div>
            </a>
            
        </div>
        <div class="curtain" v-show="menu_show"></div>
    </div>

</nav>
                </div>

                <div id="main">
                    <div id="home-head" style=background-image:url('home.jpg')>
    <script>
        var menu = document.getElementById("menu")
        menu.className += " menu-color"
    </script>
     
    <div id="home-info" class="home-info" @click="home_click">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>61分</h1>
                <h3></h3>
                <h5></h5>
            </div>
        </span>
    </div>
     
</div>



<div id="home-posts-wrap" class=>
    <div id="home-posts">

        <div id="posts">
            

<div class="post">

    <a href="/2022/04/23/4-23/分布式系统理论/">
        <h2>
            分布式-Dubbo-Zookeeper
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/23
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <p>安装zookeeper</p>
<p><a target="_blank" rel="noopener" href="https://archive.apache.org/dist/zookeeper/zookeeper-3.7.0/">https://archive.apache.org/dist/zookeeper/zookeeper-3.7.0/</a></p>
<p>下载编译后二进制的包</p>
<p>运行bin目录下的zkServer.cmd windows下</p>
<p>闪退解决：修改配置文件 加个暂停(pause)查看错误的原因</p>
<p>原因是conf目录下没有 zoo.cfg 复制sample进行添加</p>
<p>连接服务zkServer.cmd</p>
<p>连接客户端zkCli.cmd</p>
<p>在项目中打包dubbo-admin</p>
<p><code>mvn clean package -Dmaven.test.skip=true</code></p>
<p>admin的地址为7001</p>
<p>默认账号密码都是 root</p>
<p>dubbo-admin是一个监控管理后台，查看我们哪些服务注册，被消费</p>
<p>zookeeper是 注册中心</p>
<p>导入依赖</p>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt;
  &lt;artifactId&gt;zkclient&lt;/artifactId&gt;
  &lt;version&gt;0.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;
  &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;
  &lt;version&gt;2.7.3&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>日志冲突</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.dubbo&lt;/groupId&gt;
    &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;2.7.3&lt;/version&gt;

    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
</code></pre>
<p>配置文件</p>
<pre><code class="properties">#服务应用名字
dubbo.application.name=provider
#注册中心地址
dubbo.registry.address=zookeeper://127.0.1:2181
#哪些服务需要被注册
dubbo.scan.base-packages=com.xiaoliu.service
</code></pre>
<p>接下来再导入依赖</p>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;
  &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt;
  &lt;version&gt;2.12.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;
  &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;
  &lt;version&gt;3.4.14&lt;/version&gt;
  &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;
</code></pre>
<p>这个需要排除sl4j的依赖</p>
<pre><code class="properties">#消费者需要去哪拿服务需要暴露名字

dubbo.application.name=provider

#去注册中心

dubbo.registry.address=zookeeper://127.0.1:2181
</code></pre>
<p>消费者业务接口</p>
<pre><code class="java">消费者生产者接口都必须相同
    @Service
public class Service&#123;
    @Reference//引用，Pom坐标，可以定义路径相同的接口名，远程引用
    TicketService ticketService;
    
    public void buyTicket()&#123;
        String ticket = ticketService.getTicket();
        System.out.println(&quot;拿到票&quot;+ticket);
    &#125;
&#125;
</code></pre>
<p>1、提供者提供服务</p>
<p>​    1.导入依赖</p>
<p>​    2.配置注册中心地址，以及服务发现名，和要扫描的包</p>
<p>​    3.在想要被注册的服务上面 增加一个注解 @Service</p>
<p>2、消费者如何消费</p>
<p>​    1.导入依赖</p>
<p>​    2.配置注册中心地址，配置自己的服务名</p>
<p>​    3.从远程注入服务 @Reference</p>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/23/4-23/分布式系统理论/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/23/4-23/异步任务/">
        <h2>
            任务
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/23
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h1 id="异步任务"><a href="#异步任务" class="headerlink" title="异步任务"></a>异步任务</h1><p>在业务需要异步处理的方法加入注解 <code>@Async</code></p>
<p>在启动类加入 <code>@EnableAsync</code></p>
<p>在控制层加入加入业务即可</p>
<h1 id="邮件任务"><a href="#邮件任务" class="headerlink" title="邮件任务"></a>邮件任务</h1><p>这里用qq邮件</p>
<p>配置文件</p>
<pre><code class="properties">#开启加密验证
spring.mail.properties.mail.smtp.ssl.enable=true

spring.mail.username=1937589397@qq.com
spring.mail.password=ixxxxxxxxxxb
spring.mail.host=smtp.qq.com
</code></pre>
<pre><code class="java">@Autowired
    JavaMailSender mailSender;

    @Test
    void contextLoads() &#123;
//        发送邮件
//        发件人
//        内容
        SimpleMailMessage message = new SimpleMailMessage();
        message.setSubject(&quot;小刘&quot;);
        message.setText(&quot;hello&quot;);

        message.setFrom(&quot;1937589397@qq.com&quot;);
        message.setTo(&quot;1937589397@qq.com&quot;);

        mailSender.send(message);

    &#125;
</code></pre>
<p>复杂邮件</p>
<pre><code class="java"> MimeMessage mimeMessage = mailSender.createMimeMessage();
//        组装
        MimeMessageHelper helper = new MimeMessageHelper(mimeMessage,true);

        helper.setSubject(subject);
        helper.setText(text,true);

//        附件
        helper.addAttachment(&quot;1.jpg&quot;,new File(&quot;D:\\壁纸\\5b8b4cf6143640c98cd46cd77d26f292.jpg&quot;));

        helper.setTo(&quot;1937589397@qq.com&quot;);
        helper.setFrom(&quot;1937589397@qq.com&quot;);

        mailSender.send(mimeMessage);
</code></pre>
<h1 id="定时执行任务"><a href="#定时执行任务" class="headerlink" title="定时执行任务"></a>定时执行任务</h1><pre><code class="java">TaskeScheduler 任务调度者

TaskExecutor 认为执行者

@EnableScueduling开启定时功能的注解在启动类
@Scheduled 什么时候执行
    
Cron表达式
</code></pre>
<pre><code class="java">@Service
public class ScheduleService &#123;

//    cron表达
//    秒 分 时 日 月 周几
//    下面表达式表示是 每一周的每0秒执行
//@Scheduled(cron = &quot;0 * * * * 0-7&quot;)
//    下面表达的是 每一天天的16时 44分 执行
    @Scheduled(cron = &quot;1 48 16 * * ?&quot;)
//    30 0/5 10 18, * ? 每天 10点和18点 每隔五分钟执行一次
    public void hello()&#123;
        System.out.println(&quot;您被执行了&quot;);
    &#125;
&#125;
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/23/4-23/异步任务/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/22/4-22/swagger/">
        <h2>
            swagger
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/22
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <p>Swagger简介</p>
<p>前后端分离</p>
<p>Vue + SpringBoot</p>
<h1 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h1><p>最流行的API框架</p>
<p>在项目中使用swagger需要springfox；</p>
<ul>
<li>swagger2</li>
<li>ui</li>
</ul>
<h1 id="spirngboot集成swagger"><a href="#spirngboot集成swagger" class="headerlink" title="spirngboot集成swagger"></a>spirngboot集成swagger</h1><p>1、新建springweb项目</p>
<p>2、导入依赖</p>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.springfox&lt;/groupId&gt;
  &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
  &lt;version&gt;3.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.springfox&lt;/groupId&gt;
  &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
  &lt;version&gt;3.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>3、配置swagger</p>
<pre><code class="JAVA">@Configuration
@EnableSwagger2//开启swagger2
public class SwaggerConfig &#123;
&#125;
</code></pre>
<p>测试页面</p>
<p><strong><a target="_blank" rel="noopener" href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a></strong></p>
<p>swagger的bean实例 Docket</p>
<p>SwaggerConfig</p>
<pre><code class="java">package com.xiaoliu.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import springfox.documentation.RequestHandler;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.Contact;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

import java.util.ArrayList;

/**
 * @author: 61分
 * @date: 2022/4/22 17:39
 * @description:
 */

@Configuration
@EnableSwagger2//开启swagger2
public class SwaggerConfig &#123;

//    配置swagger的Docket bean实例
    @Bean
    public Docket docket()&#123;
        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
    &#125;

//    配置swagger信息=apiinfo
    private ApiInfo apiInfo()&#123;
        System.out.println(&quot;doswagger&quot;);
//        作者信息
        Contact contact = new Contact(&quot;xiaoliu&quot;, &quot;https://dddwah11.github.io/&quot;, &quot;1937589397@qq.com&quot;);

        return new ApiInfo(
                &quot;APIInfo&quot;,
                &quot;swagger配置&quot;,
                &quot;v1.0&quot;,
                &quot;https://dddwah11.github.io/&quot;,
                contact,
                &quot;Apache 2.0&quot;,
                &quot;http://www.apache.org/licenses/LINCENSE-2.0&quot;,
                new ArrayList&lt;&gt;()
        );
    &#125;
&#125;
</code></pre>
<h1 id="Swagger配置扫描接口"><a href="#Swagger配置扫描接口" class="headerlink" title="Swagger配置扫描接口"></a>Swagger配置扫描接口</h1><p>Docket.select()</p>
<pre><code class="java">                .enable(false);//
                .select()
//                RequestHandlerSelectors配置需要扫描接口的方式
//                basePackage指定要扫描的包
//                any()扫描全部
//                none()都不扫描
//               withClassAnnotation;扫描类上的注解，参数是一个注解的反射对象
//                withMethodAnnotation;扫描方法上的注解
                    .apis(RequestHandlerSelectors.basePackage(&quot;com.xiaoliu.helloController&quot;))
//                path()过滤路径

                .build();
</code></pre>
<p>配置是否启动swagger</p>
<pre><code class="java">            .enable(false);//不启动swagger
            .select()
</code></pre>
<p>我们希望swagger在生产环境中使用，在发布时不使用</p>
<ul>
<li>判断是不是生产环境 </li>
<li>注入 enable()</li>
</ul>
<pre><code class="java">    @Bean
    public Docket docket(Environment environment)&#123;
//        设置要显示的flag环境
        Profiles profiles =Profiles.of(&quot;dev&quot;,&quot;test&quot;);
//        获取项目环境
//        通过environment.acceptsProfiles判断是否处在自己设定的环境
        boolean b = environment.acceptsProfiles(profiles);



        return new Docket(DocumentationType.SWAGGER_2)
                .apiInfo(apiInfo())
                .enable(b)
</code></pre>
<p>配置文件中设置生产和发布环境</p>
<p>主配置文件设置</p>
<pre><code class="xml">spring.profiles.active=当前环境
</code></pre>
<h1 id="swagger配置API文档分组"><a href="#swagger配置API文档分组" class="headerlink" title="swagger配置API文档分组"></a>swagger配置API文档分组</h1><pre><code class="java">.apiInfo(apiInfo())
.groupName(&quot;hello&quot;)
</code></pre>
<p>如何配置多个分组</p>
<pre><code class="java">@Bean
public Docket docket1()&#123;
    return new Docket(DocumentationType.SWAGGER_2).groupName(&quot;A&quot;);
&#125;
</code></pre>
<p><code>@ApiModel()//文档注释</code></p>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/22/4-22/swagger/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/21/4-21/shiro/">
        <h2>
            shiro安全框架 -springboot中集成
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/21
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <p>1、导入依赖</p>
<p>2、配置文件</p>
<p>3、应用程序</p>
<pre><code class="java">获取当前对象
Subject currentUser = SecurityUtils.getSubject();
获取当前session
Session session = currentUser.getSession();
判断用户是否被认证
currentUser.isAuthenticated()
获取当前认证
currentUser.getPrincipal()    
用户角色
currentUser.hasRole  
粗粒度    
currentUser.isPermitted(&quot;lightsaber:wield&quot;)
细粒度    
currentUser.isPermitted(&quot;winnebago:drive:eagle5&quot;)
登出
currentUser.logout()    
</code></pre>
<h1 id="shiro登录认证"><a href="#shiro登录认证" class="headerlink" title="shiro登录认证"></a>shiro登录认证</h1><p>1、创建realm对象，需要自定义类：</p>
<pre><code class="java">public class UserRealm extends AuthorizingRealm &#123;

//授权
    @Override
    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) &#123;
        System.out.println(&quot;授权doGetAuthorizationInfo&quot;);
        return null;
    &#125;
//认证
    @Override
    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException &#123;
        System.out.println(&quot;认证doGetAuthenticationInfo&quot;);
        return null;
    &#125;
&#125;
</code></pre>
<pre><code class="java">@Configuration
public class shiroConfig &#123;

//    ShiroFilterFactoryBean
//    Manager
//    创建realm对象
    @Bean
    public UserRealm userRealm()&#123;
        return new UserRealm();
    &#125;
&#125;
</code></pre>
<p>2、defaultWebSecurityManager</p>
<pre><code class="java">@Bean
    public DefaultWebSecurityManager getDefaultWebSecurityManager(@Qualifier(&quot;userRealm&quot;) UserRealm userRealm)&#123;
        DefaultWebSecurityManager defaultWebSecurityManager = new DefaultWebSecurityManager();
        defaultWebSecurityManager.setRealm(userRealm);
//        关联realm
        return defaultWebSecurityManager;
    &#125;
</code></pre>
<p>3、shiroFiterFactoryBean</p>
<pre><code class="java">    @Bean(name = &quot;DefaultWebSecurityManager&quot;)
    public ShiroFilterFactoryBean getShiroFilterFactoryBean(@Qualifier(&quot;DefaultWebSecurityManager&quot;) DefaultWebSecurityManager defaultWebSecurityManager)&#123;
        ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean();
//        关联webSecurityManager
        shiroFilterFactoryBean.setSecurityManager(defaultWebSecurityManager);
        return shiroFilterFactoryBean;
    &#125;
</code></pre>
<p>ShiroFilterFactoryBean </p>
<pre><code class="java">@Bean
    public ShiroFilterFactoryBean getShiroFilterFactoryBean(@Qualifier(&quot;securityManager&quot;) DefaultWebSecurityManager defaultWebSecurityManager)&#123;
        ShiroFilterFactoryBean bean = new ShiroFilterFactoryBean();
//        关联webSecurityManager
//        设置安全管理器
        bean.setSecurityManager(defaultWebSecurityManager);
//        添加shiro的内置过滤器
        /*
            anon:无需认证
            authc: 必须认证
            user: 必须拥有 记住我 功能才能实现
            perms: 拥有对某个资源权限功能才能能访问
            role: 拥有某个角色权限
         */

        Map&lt;String, String&gt; filterMap = new LinkedHashMap&lt;&gt;();


        filterMap.put(&quot;/user/add&quot;,&quot;authc&quot;);
        filterMap.put(&quot;/user/update&quot;,&quot;authc&quot;);
        System.out.println(&quot;filterMap&quot;);

       bean.setFilterChainDefinitionMap(filterMap);
        return bean;
    &#125;
</code></pre>
<p>可在ShiroFilterFactoryBean 设置登录</p>
<p><code>bean.setLoginUrl(&quot;/toLogin&quot;);</code>                        </p>
<h1 id="shiro实现用户认证"><a href="#shiro实现用户认证" class="headerlink" title="shiro实现用户认证"></a>shiro实现用户认证</h1><p>在Controller中</p>
<pre><code class="java">@RequestMapping(&quot;/login&quot;)
    public String login(String username,String password)&#123;
        //        获取对象
        Subject subject = SecurityUtils.getSubject();

//        封装登录对象的数据为token
        UsernamePasswordToken token = new UsernamePasswordToken(username, password);
                subject.login(token);
        try &#123;
            subject.login(token);//执行登录方法，无异常就执行
            return &quot;index&quot;;
        &#125; catch (UnknownAccountException e) &#123;//用户名不存在
            model.addAttribute(&quot;msg&quot;,&quot;用户名错误&quot;);
            return &quot;login&quot;;
        &#125; catch (IncorrectCredentialsException e)&#123;//密码不存在
            model.addAttribute(&quot;msg&quot;,&quot;密码错误&quot;);
            return &quot;login&quot;;
        &#125; catch (LockedAccountException e)&#123;
            model.addAttribute(&quot;msg&quot;,&quot;账号被锁定&quot;);
            return &quot;login&quot;;
        &#125;
    &#125;
</code></pre>
<p>UserRealm类中</p>
<pre><code class="java">@Override
    protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException &#123;
        System.out.println(&quot;认证doGetAuthenticationInfo&quot;);

//        用户名，密码，数据库中取
        String username= &quot;root&quot;;
        String password= &quot;123456&quot;;
        UsernamePasswordToken token = (UsernamePasswordToken) authenticationToken;
        if (!token.getUsername().equals(username))&#123;
            return null;//抛出异常UnknownAccountException
        &#125;
//        密码认证shiro做
        return new SimpleAuthenticationInfo(&quot;&quot;,password,&quot;&quot;);
    &#125;
</code></pre>
<h1 id="Shiro整合Mybatis"><a href="#Shiro整合Mybatis" class="headerlink" title="Shiro整合Mybatis"></a>Shiro整合Mybatis</h1><p>搭建脚手架并测试，通过再进行下面的测试</p>
<p>在UserRealm中导入业务层接口</p>
<pre><code class="java">@Autowired
UserService userService;
</code></pre>
<pre><code class="java">//      连接数据库
        UsernamePasswordToken userToken = (UsernamePasswordToken) authenticationToken;
        User user = userService.queryUserByName(userToken.getUsername());

        if (user==null)&#123;
            //查无此人
            return null;//UnknownAccountException
        &#125;

//        密码认证shiro做
        return new SimpleAuthenticationInfo(&quot;&quot;,user.getPassword(),&quot;&quot;);
    &#125;
</code></pre>
<p>UserRealm类中</p>
<pre><code class="java">//      连接数据库
        UsernamePasswordToken userToken = (UsernamePasswordToken) authenticationToken;
        User user = userService.queryUserByName(userToken.getUsername());

        if (user==null)&#123;
            //查无此人
            return null;//UnknownAccountException
        &#125;

//        加密：MD5加密，MD5盐值加密
//        md5：xwefqbrb134513451223qwer md5+盐值： xwefqbrb134513451223qwerusername
//        密码认证shiro做，加密了
//        密码认证shiro做
        return new SimpleAuthenticationInfo(&quot;&quot;,user.getPassword(),&quot;&quot;);
    &#125;
</code></pre>
<h1 id="Shiro请求授权实现"><a href="#Shiro请求授权实现" class="headerlink" title="Shiro请求授权实现"></a>Shiro请求授权实现</h1><p> 在shiroConfig类中</p>
<pre><code class="java">//        授权
        filterMap.put(&quot;/user/add&quot;,&quot;perms[user:add]&quot;);
</code></pre>
<p>设置未授权的请求</p>
<pre><code class="java">//       设置未授权的请求
       bean.setUnauthorizedUrl(&quot;/noauth&quot;);
</code></pre>
<p>设置Controller</p>
<pre><code class="java">@RequestMapping(&quot;/noauth&quot;)
@ResponseBody
public String unauthorized()&#123;
        return &quot;未经授权无法访问该页面&quot;;
&#125;
</code></pre>
<p>编写controller层</p>
<pre><code class="java">@RequestMapping(&quot;/noauth&quot;)
@ResponseBody
public String unauthorized()&#123;
        return &quot;未经授权无法访问该页面&quot;;
&#125;
</code></pre>
<h2 id="授权、"><a href="#授权、" class="headerlink" title="授权、"></a>授权、</h2><pre><code class="java">//授权
    @Override
    protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) &#123;
        System.out.println(&quot;授权doGetAuthorizationInfo&quot;);
        SimpleAuthorizationInfo info = new SimpleAuthorizationInfo();
        info.addStringPermission(&quot;user:add&quot;);//这行是全部人都获取授权，想指定的人获得授权就注释这行
        return info;
    &#125;
</code></pre>
<p>指定数据库中的某些用户获取数据</p>
<p>数据库中设定权限</p>
<p>UserRealm类中</p>
<pre><code class="java">//      拿到当前登录的对象
        Subject subject = SecurityUtils.getSubject();
        User currentUser = (User)subject.getPrincipal();//拿到user对象

        info.addStringPermission(currentUser.getPerms());
        return info;
</code></pre>
<p>shiroConfig类中</p>
<pre><code class="java">filterMap.put(&quot;/user/add&quot;,&quot;perms[user:add]&quot;);
filterMap.put(&quot;/user/update&quot;,&quot;perms[user:update]&quot;);
</code></pre>
<h1 id="Shiro整合Thymeleaf"><a href="#Shiro整合Thymeleaf" class="headerlink" title="Shiro整合Thymeleaf"></a>Shiro整合Thymeleaf</h1><p>导入依赖 shiro-thymeleaf</p>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.github.theborakompanioni&lt;/groupId&gt;
  &lt;artifactId&gt;thymeleaf-extras-shiro&lt;/artifactId&gt;
  &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>在UserRealm类中</p>
<pre><code class="java">//    整合shirodialect：整合 th 和 shiro
    @Bean
    public ShiroDialect getshiroDialect()&#123;
        return new ShiroDialect();
    &#125;
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/21/4-21/shiro/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/18/4-18/整合中Mybatis/">
        <h2>
            整合Mybatis
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/18
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <p>准备工作：搭建环境并测试（导入包，配置文件，myabtis配置，编写sql）</p>
<h1 id="1、编写实体类"><a href="#1、编写实体类" class="headerlink" title="1、编写实体类"></a>1、编写实体类</h1><pre><code class="java">package com.xiaoliu.pojo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * @author: 61分
 * @date: 2022/4/18 15:29
 * @description:
 */

@Data
@AllArgsConstructor
@NoArgsConstructor
public class User &#123;
    private Integer id;
    private String name;
    private String password;
&#125;
</code></pre>
<h1 id="2、编写接口"><a href="#2、编写接口" class="headerlink" title="2、编写接口"></a>2、编写接口</h1><pre><code class="java">package com.xiaoliu.mapper;

/**
 * @author: 61分
 * @date: 2022/4/18 15:32
 * @description:
 */

@org.apache.ibatis.annotations.Mapper
public interface Mapper &#123;
&#125;
</code></pre>
<pre><code class="java">@Repository //Dao层 用该注解
</code></pre>
<p>再到resource目录下配置xml文件</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.xiaoliu.mapper&quot;&gt;
  &lt;select id=&quot;selectBlog&quot; resultType=&quot;User&quot;&gt;
    select * from Blog where id = #&#123;id&#125;
  &lt;/select&gt;
&lt;/mapper&gt;
</code></pre>
<p>在springboot中配置文件别名及mapper.xml文件</p>
<pre><code class="yaml">mybatis.type-aliases-package=com.xiaoliu.pojo
mybatis.mapper-locations=classpath:/mybatis/mapper/*.xml
</code></pre>
<p>增删改查</p>
<pre><code class="xml">&lt;select id=&quot;queryUserListById&quot; resultType=&quot;User&quot;&gt;
    select * from mybatis.user where id = #&#123;id&#125;
&lt;/select&gt;

&lt;select id=&quot;queryUserList&quot; resultType=&quot;User&quot;&gt;
    select * from mybatis.user
&lt;/select&gt;

&lt;insert id=&quot;addUser&quot; parameterType=&quot;User&quot;&gt;
    insert into mybatis.user (id, name, password) values (#&#123;id&#125;,#&#123;name&#125;,#&#123;password&#125;);
&lt;/insert&gt;

&lt;update id=&quot;updateUser&quot; parameterType=&quot;User&quot;&gt;
    update mybatis.user
    set name = #&#123;name&#125;,
        password = #&#123;password&#125;
    where id = #&#123;id&#125;;
</code></pre>
<p>配置文件：</p>
<pre><code class="properties"># 应用名称
spring.application.name=mybatisSpringboot
# 数据库驱动：
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
# 数据源名称
spring.datasource.name=defaultDataSource
# 数据库连接地址
spring.datasource.url=jdbc:mysql://localhost:3306/mybatis?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf-8
# 数据库用户名&amp;密码：
spring.datasource.username=root
spring.datasource.password=123456
# 应用服务 WEB 访问端口
server.port=8080

mybatis.type-aliases-package=com.xiaoliu.pojo
mybatis.mapper-locations=classpath:/mybatis/mapper/*.xml
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/18/4-18/整合中Mybatis/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/18/4-18/整合druid/">
        <h2>
            整合Druid
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/18
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h1 id="1、导入相关依赖"><a href="#1、导入相关依赖" class="headerlink" title="1、导入相关依赖"></a>1、导入相关依赖</h1><pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j&lt;/artifactId&gt;
    &lt;version&gt;1.2.12&lt;/version&gt;
&lt;/dependency&gt;


&lt;dependency&gt;
    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
    &lt;artifactId&gt;druid&lt;/artifactId&gt;
    &lt;version&gt;1.2.9&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h1 id="2、配置文件"><a href="#2、配置文件" class="headerlink" title="2、配置文件"></a>2、配置文件</h1><pre><code class="yml">type: com.alibaba.druid.pool.DruidDataSource

  #SpringBoot默认是不注入这些的，需要自己绑定
  #druid数据源专有配置
  initialSize: 5
  minIdle: 5
  maxActive: 20
  maxWait: 60000
  timeBetweenEvictionRunsMillis: 60000
  minEvictableIdleTimeMillis: 300000
  validationQuery: SELECT 1 FROM DUAL
  testWhileIdle: true
  testOnBorrow: false
  testOnReturn: false
  poolPreparedStatements: true

  #配置监控统计拦截的filters，stat：监控统计、log4j：日志记录、wall：防御sql注入
  #如果允许报错，java.lang.ClassNotFoundException: org.apache.Log4j.Properity
  #则导入log4j 依赖就行
  filters: stat,wall,log4j
  maxPoolPreparedStatementPerConnectionSize: 20
  useGlobalDataSourceStat: true
  connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500
</code></pre>
<p><strong>配置进去没用，也能进去，先放着</strong></p>
<h1 id="3、绑定配置文件"><a href="#3、绑定配置文件" class="headerlink" title="3、绑定配置文件"></a>3、绑定配置文件</h1><pre><code class="java">package com.xiaoliu.config;

import com.alibaba.druid.pool.DruidDataSource;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import javax.sql.DataSource;

/**
 * @author: 61分
 * @date: 2022/4/18 14:33
 * @description:
 */
@Configuration
public class DruidConfig &#123;

    @ConfigurationProperties(prefix = &quot;spring.datasource&quot;)
    @Bean
    public DataSource DruidDataSource()&#123;
        return new DruidDataSource();
    &#125;
&#125;
</code></pre>
<h1 id="4、DruidConfig"><a href="#4、DruidConfig" class="headerlink" title="4、DruidConfig"></a>4、DruidConfig</h1><pre><code class="java">package com.xiaoliu.config;

import com.alibaba.druid.pool.DruidDataSource;
import com.alibaba.druid.support.http.StatViewServlet;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.web.servlet.ServletRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import javax.sql.DataSource;
import java.util.HashMap;

/**
 * @author: 61分
 * @date: 2022/4/18 14:33
 * @description:
 */
@Configuration
public class DruidConfig &#123;

    @ConfigurationProperties(prefix = &quot;spring.datasource&quot;)
    @Bean
    public DataSource DruidDataSource()&#123;
        return new DruidDataSource();
    &#125;

//    后台监控:web.xml
//    springboot集成了servlet，没有web.xml 可以使用ServletRegistrationBean，注册
    @Bean
    public ServletRegistrationBean statViewServlet()&#123;
        ServletRegistrationBean&lt;StatViewServlet&gt; bean = new ServletRegistrationBean&lt;&gt;(new StatViewServlet(), &quot;/druid/*&quot;);
//        后台有人登陆，账号密码配置
        HashMap&lt;String, String&gt; initParameter = new HashMap&lt;&gt;();
//        设置参数
        initParameter.put(&quot;loginUsername&quot;, &quot;admin&quot;);//默认的数值
        initParameter.put(&quot;loginPassword&quot;,&quot;123456&quot;);//默认的数值

//        允许谁访问
        initParameter.put(&quot;allow&quot;,&quot;&quot;);//后面参数不写，任何人都能访问
//        禁止谁访问         initParameter.put(&quot;xxx&quot;,&quot;ip地址&quot;);


        bean.setInitParameters(initParameter);//设置初始化参数
        return bean;
    &#125;
&#125;
</code></pre>
<p><strong>过滤器</strong></p>
<pre><code class="java">//    filter
    @Bean
    public FilterRegistrationBean filterStart()&#123;
        FilterRegistrationBean&lt;Filter&gt; bean = new FilterRegistrationBean&lt;&gt;();
        bean.setFilter(new WebStatFilter());
//        设置过滤请求
        HashMap&lt;String, String&gt; initParameters = new HashMap&lt;&gt;();
//        设置不统计的东西
        initParameters.put(&quot;exclusions&quot;,&quot;*.js,*.css,/druid/*&quot;);
        bean.setInitParameters(initParameters);
        return bean;

    &#125;
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/18/4-18/整合druid/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/16/4-16/springboot-web-02/">
        <h2>
            springWeb-02开发
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/16
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h1 id="员工列表展示"><a href="#员工列表展示" class="headerlink" title="员工列表展示"></a>员工列表展示</h1><ul>
<li>提前公共页面<ul>
<li>&#96;th:replace&#x3D;”~{commons&#x2F;commons::sidebar&#96;&#96;</li>
<li>&#96;&#96;<div th:replace="~{commons/commons::tobbar}"></div>&#96;</li>
<li>如果要传参，可以直接使用（）传参，接受判断</li>
</ul>
</li>
<li>列表循坏展示</li>
</ul>
<p>&#96;<tbody><br>   <tr th:each="emp:${emps}"><br>      <td th:text="${emp.getId()}"></td><br>      <td th:text="${emp.getLastName()}"></td><br>      <td th:text="${emp.getEmail()}"></td><br>      <td th:text="${emp.getGender()==0?'女':'男'}"></td><br>      <td th:text="${emp.department.getDepartment()}"></td><br>      &lt;td th:text&#x3D;”$</tr></tbody></p>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/16/4-16/springboot-web-02/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/16/4-16/springboot-web开发/">
        <h2>
            springWeb开发
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/16
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h1 id="1、首页配置：所有html页面使用thymeleaf接管："><a href="#1、首页配置：所有html页面使用thymeleaf接管：" class="headerlink" title="1、首页配置：所有html页面使用thymeleaf接管："></a>1、首页配置：所有html页面使用thymeleaf接管：</h1><p><code>url:@&#123;&#125;</code></p>
<p>首页：</p>
<pre><code class="html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;
   &lt;head&gt;
      &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
      &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;
      &lt;meta name=&quot;description&quot; content=&quot;&quot;&gt;
      &lt;meta name=&quot;author&quot; content=&quot;&quot;&gt;
      &lt;title&gt;Signin Template for Bootstrap&lt;/title&gt;
      &lt;!-- Bootstrap core CSS --&gt;
      &lt;link th:href=&quot;@&#123;/css/bootstrap.min.css&#125;&quot; rel=&quot;stylesheet&quot;&gt;
      &lt;!-- Custom styles for this template --&gt;
      &lt;link th:href=&quot;@&#123;/css/signin.css&#125;&quot; rel=&quot;stylesheet&quot;&gt;
   &lt;/head&gt;

   &lt;body class=&quot;text-center&quot;&gt;
      &lt;form class=&quot;form-signin&quot; action=&quot;dashboard.html&quot;&gt;
         &lt;img class=&quot;mb-4&quot; th:src=&quot;@&#123;/img/bootstrap-solid.svg&#125;&quot; alt=&quot;&quot; width=&quot;72&quot; height=&quot;72&quot;&gt;
         &lt;h1 class=&quot;h3 mb-3 font-weight-normal&quot;&gt;Please sign in&lt;/h1&gt;
         &lt;label class=&quot;sr-only&quot;&gt;Username&lt;/label&gt;
         &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; required=&quot;&quot; autofocus=&quot;&quot;&gt;
         &lt;label class=&quot;sr-only&quot;&gt;Password&lt;/label&gt;
         &lt;input type=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; required=&quot;&quot;&gt;
         &lt;div class=&quot;checkbox mb-3&quot;&gt;
            &lt;label&gt;
          &lt;input type=&quot;checkbox&quot; value=&quot;remember-me&quot;&gt; Remember me
        &lt;/label&gt;
         &lt;/div&gt;
         &lt;button class=&quot;btn btn-lg btn-primary btn-block&quot; type=&quot;submit&quot;&gt;Sign in&lt;/button&gt;
         &lt;p class=&quot;mt-5 mb-3 text-muted&quot;&gt;© 2017-2018&lt;/p&gt;
         &lt;a class=&quot;btn btn-sm&quot;&gt;中文&lt;/a&gt;
         &lt;a class=&quot;btn btn-sm&quot;&gt;English&lt;/a&gt;
      &lt;/form&gt;

   &lt;/body&gt;

&lt;/html&gt;
</code></pre>
<p>controller：</p>
<pre><code class="java">package com.xiaoliu.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.ViewControllerRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

/**
 * @author: 61分
 * @date: 2022/4/15 21:17
 * @description:
 */
//扩展 springmvc  dispatcherservlet
@Configuration

public class MyMvcConfig implements WebMvcConfigurer &#123;

    //视图跳转
    @Override
    public void addViewControllers(ViewControllerRegistry registry) &#123;
        registry.addViewController(&quot;/&quot;).setViewName(&quot;index&quot;);
        registry.addViewController(&quot;/index.html&quot;).setViewName(&quot;index&quot;);
    &#125;
&#125;
</code></pre>
<h2 id="2、页面国际化"><a href="#2、页面国际化" class="headerlink" title="2、页面国际化"></a>2、页面国际化</h2><p>i18n</p>
<p>设置login.properties文件，</p>
<p>login.tip</p>
<p>login.password</p>
<p>login.username</p>
<p>login.remember</p>
<p>怎么识别国际化</p>
<p>通过SpirngBoot——MessageSourceAutofiguration类</p>
<p>在配置application.properties</p>
<p><code>spring.messages.basename=i18n.login</code></p>
<p>thymeleaf国际化消息语法：<code>#&#123;&#125;</code></p>
<pre><code class="html">th:text=&quot;#&#123;login.password&#125;&quot;
</code></pre>
<p>实现语言切换</p>
<pre><code class="html">th:href=&quot;@&#123;/index.html(l=&#39;zh_CN&#39;)&#125;&quot;&gt;中文
</code></pre>
<pre><code class="html">th:href=&quot;@&#123;/index.html(l=&#39;en_US&#39;)&#125;&quot;&gt;Englis
</code></pre>
<p>div自己的组件在config中的MyMvcConfig类中</p>
<p>并将其配置到springboot容器中 <code>@Bean</code></p>
<pre><code class="java">//    向容器中注入组件，自定义的国际化组件
    @Bean
    public LocaleResolver localeResolver()&#123;
        return new MylocalResolver();
    &#125;
</code></pre>
<p>自定义的组件</p>
<pre><code class="java">package com.xiaoliu.config;

import org.springframework.util.StringUtils;
import org.springframework.web.servlet.LocaleResolver;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.util.Locale;

/**
 * @author: 61分
 * @date: 2022/4/16 15:22
 * @description:
 */
public class MylocalResolver implements LocaleResolver &#123;
    @Override
    public Locale resolveLocale(HttpServletRequest httpServletRequest) &#123;
//      获取语言参数
        String language = httpServletRequest.getParameter(&quot;l&quot;);
        Locale locale = Locale.getDefault(); //如果没有就使用默认的
//        如果请求中携带了地区化的参数
        if (!StringUtils.isEmpty(language))&#123;
//            分割 zh_CN
            String[] split = language.split(&quot;_&quot;);
//           国家 地区
             locale = new Locale(split[0], split[1]);
        &#125;
        return locale;
    &#125;

    @Override
    public void setLocale(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, Locale locale) &#123;

    &#125;
&#125;
</code></pre>
<h1 id="修改返回的url"><a href="#修改返回的url" class="headerlink" title="修改返回的url"></a>修改返回的url</h1><p>在自定义的视图跳转MyMvcConfig中</p>
<p>视图跳转到dashboard的时候 名字为：main.html</p>
<pre><code class="java">registry.addViewController(&quot;/main.html&quot;).setViewName(&quot;dashboard&quot;);
</code></pre>
<p>在controller返回重定向的页面为&#x2F;main.html</p>
<pre><code class="java">if (!StringUtils.isEmpty(username) &amp;&amp; &quot;123&quot;.equals(password)) &#123;
    return &quot;redirect:/main.html&quot;;
</code></pre>
<h1 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h1><p>在config中 编写LoginHandlerInterceptor拦截器</p>
<pre><code class="java">package com.xiaoliu.config;

import org.springframework.web.servlet.HandlerInterceptor;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * @author: 61分
 * @date: 2022/4/16 16:14
 * @description:
 */
public class LoginHandlerInterceptor implements HandlerInterceptor &#123;
    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123;
//        登录之后应该有用户的session
        Object loginUser = request.getSession().getAttribute(&quot;loginUser&quot;);

        if (loginUser==null)&#123;
            request.setAttribute(&quot;msg&quot;,&quot;没有权限，请先登录！&quot;);
            request.getRequestDispatcher(&quot;/index.html&quot;).forward(request,response);
            return false;
        &#125;else return true;
    &#125;


&#125;
</code></pre>
<p>在mvc类中重写拦截器</p>
<pre><code class="java">@Override
public void addInterceptors(InterceptorRegistry registry) &#123;
    registry.addInterceptor(new LoginHandlerInterceptor())
            .addPathPatterns(&quot;/**&quot;)//拦截的页面
            .excludePathPatterns(&quot;/&quot;,&quot;/index.html&quot;,&quot;/user/login&quot;,&quot;/css/**&quot;,&quot;/js/**&quot;,&quot;/img/**&quot;);//不能被拦截的页面
&#125;
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/16/4-16/springboot-web开发/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/16/4-16/在javav中建立数据表/">
        <h2>
            通过java自建数据表
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/16
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h1 id="建立一个员工部门表："><a href="#建立一个员工部门表：" class="headerlink" title="建立一个员工部门表："></a>建立一个员工部门表：</h1><h1 id="pojo"><a href="#pojo" class="headerlink" title="pojo:"></a>pojo:</h1><p><strong>Employee:</strong></p>
<pre><code class="java">package com.xiaoliu.pojo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.util.Date;

/**
 * @author: 61分
 * @date: 2022/4/15 23:12
 * @description:
 */
@Data
@NoArgsConstructor
public class Employee &#123;
    private Integer id;
    private String lastName;
    private String email;
    private Integer gender;

    private Department department;
    private Date birth;

    public Employee(Integer id, String lastName, String email, Integer gender, Department department) &#123;
        this.id = id;
        this.lastName = lastName;
        this.email = email;
        this.gender = gender;
        this.department = department;
        this.birth = new Date();
    &#125;
&#125;
</code></pre>
<p><strong>Department:</strong></p>
<pre><code class="java">package com.xiaoliu.pojo;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

/**
 * @author: 61分
 * @date: 2022/4/15 22:17
 * @description:
 */

@Data
@AllArgsConstructor
@NoArgsConstructor
public class Department &#123;
    private Integer id;
    private String department;
&#125;
</code></pre>
<h2 id="Dao层："><a href="#Dao层：" class="headerlink" title="Dao层："></a>Dao层：</h2><p><strong>EmployeeDao：</strong></p>
<pre><code class="java">package com.xiaoliu.dao;

import com.xiaoliu.pojo.Department;
import com.xiaoliu.pojo.Employee;
import org.springframework.beans.factory.annotation.Autowired;

import java.util.Collection;
import java.util.HashMap;
import java.util.Map;

/**
 * @author: 61分
 * @date: 2022/4/15 23:44
 * @description:
 */
public class EmployeeDao &#123;
    private static Map&lt;Integer, Employee&gt; employees;

    @Autowired
    private DepartmentDao departmentDao;

    static &#123;
        employees = new HashMap&lt;Integer, Employee&gt;();//创建一个部门表
        employees.put(1001, new Employee(1001,&quot;AA&quot;,&quot;A13151@ew.com&quot;,0,new Department(101,&quot;教学部&quot;)));
        employees.put(1002, new Employee(1002,&quot;BB&quot;,&quot;B13151@ew.com&quot;,1,new Department(102,&quot;后勤部&quot;)));
        employees.put(1003, new Employee(1003,&quot;CC&quot;,&quot;C13151@ew.com&quot;,0,new Department(103,&quot;保卫部&quot;)));
        employees.put(1004, new Employee(1004,&quot;DD&quot;,&quot;D13151@ew.com&quot;,1,new Department(104,&quot;科研部&quot;)));
        employees.put(1005, new Employee(1005,&quot;EE&quot;,&quot;E13151@ew.com&quot;,0,new Department(105,&quot;学生部&quot;)));

    &#125;

//    主键自增ID
    private static Integer initId = 1006;
//    增加一个员工
    public void save(Employee employee)&#123;
        if (employee.getId()==0)&#123;
            employee.setId(initId++);
        &#125;

        employee.setDepartment(departmentDao.getDepartment(employee.getDepartment().getId()));

        employees.put(employee.getId(),employee);
    &#125;

//    查询全部员工
    public Collection&lt;Employee&gt; getAll()&#123;
        return employees.values();
    &#125;

//    通过id查询员工
    public Employee getById(Integer id)&#123;
        return employees.get(id);
    &#125;

//    删除员工通过id
    public Employee removeById(Integer id)&#123;
        return employees.remove(id);
    &#125;
&#125;
</code></pre>
<p><strong>DepartmentDao：</strong></p>
<pre><code class="java">package com.xiaoliu.dao;

import com.xiaoliu.pojo.Department;

import java.util.Collection;
import java.util.HashMap;
import java.util.Map;

/**
 * @author: 61分
 * @date: 2022/4/15 23:18
 * @description:
 */
public class DepartmentDao &#123;
//    模拟数据库中的数据
        private  static Map&lt;Integer, Department&gt; departments = null;
    static &#123;
        departments = new HashMap&lt;Integer, Department&gt;();//创建一个部门数据表
        departments.put(101,new Department(101,&quot;教学部&quot;));
        departments.put(102,new Department(102,&quot;后勤部&quot;));
        departments.put(103,new Department(103,&quot;保卫部&quot;));
        departments.put(104,new Department(104,&quot;科研部&quot;));
        departments.put(105,new Department(105,&quot;学生部&quot;));

    &#125;
//    获得部门信息
    public Collection&lt;Department&gt; getDepartments()&#123;
        return departments.values();
    &#125;

//    通过id得到部门
    public Department getDepartment(Integer id)&#123;
        return departments.get(id);
    &#125;
&#125;
</code></pre>

            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/16/4-16/在javav中建立数据表/ " class="go-post">
        阅读全文
    </a>
</div>

<div class="post">

    <a href="/2022/04/15/4-15/thymeleaf语法/">
        <h2>
            MVC配置原理及thymeleaf
        </h2>
    </a>

    <div class="category-and-date">

        

        <span class="date">
            <span class="icon">
                <a-icon type="calendar" theme="filled" />
            </span>
            2022/4/15
        </span>

    </div>

    <div class="excerpt">
        <div class="content" v-pre>
            
            
            <h1 id="MVC配置原理"><a href="#MVC配置原理" class="headerlink" title="MVC配置原理"></a>MVC配置原理</h1><p>如果想要div一些定制化的功能，只要写一个组件，然后将它交给springboot，springboot就会自动帮我们转配</p>
<pre><code class="java">package com.xiaoliu.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.View;
import org.springframework.web.servlet.ViewResolver;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

import java.util.Locale;

/**
 * @author: 61分
 * @date: 2022/4/15 21:17
 * @description:
 */
//扩展 springmvc  dispatcherservlet
@Configuration

public class MyMvcConfig implements WebMvcConfigurer &#123;


    @Bean
    public ViewResolver myViewResolver()&#123;
        return new myViewResolver();
    &#125;

//    自定义一个视图解析器
    public static class myViewResolver implements ViewResolver &#123;
        @Override
        public View resolveViewName(String s, Locale locale) throws Exception &#123;
            return null;
        &#125;
    &#125;
&#125;
</code></pre>
<p>基本的视图跳转</p>
<pre><code class="java">public class MyMvcConfig implements WebMvcConfigurer &#123;

    //视图跳转
    @Override
    public void addViewControllers(ViewControllerRegistry registry) &#123;
        registry.addViewController(&quot;/xiaoliu&quot;).setViewName(&quot;index&quot;);
    &#125;
&#125;
</code></pre>
<p><strong>这样的话，视图跳转的文件，只能在templates，</strong>  <strong>而且thymeleaf也会失效</strong></p>
<p>如果要扩展的话，官方建议这样去做</p>
<p>springboot中，xxxConfiguraion 可以实现很多扩展</p>
<h1 id="thymeleaf"><a href="#thymeleaf" class="headerlink" title="thymeleaf"></a>thymeleaf</h1><p><strong>thymeleaf常用命名空间</strong>：</p>
<p>xmlns:th&#x3D;”<a target="_blank" rel="noopener" href="http://www.thymeleaf.org&quot;/">http://www.thymeleaf.org&quot;</a><br>xmlns:sec&#x3D;”<a target="_blank" rel="noopener" href="http://www.thymeleaf.org/extras/spring-security&quot;">http://www.thymeleaf.org/extras/spring-security&quot;</a><br>xmlns:shiro&#x3D;”<a target="_blank" rel="noopener" href="http://www.pollix.at/thymeleaf/shiro&quot;">http://www.pollix.at/thymeleaf/shiro&quot;</a></p>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
</html>
            
        </div>
    </div>

    <div class="post-tags">
        
        
    </div>

    <a href="/2022/04/15/4-15/thymeleaf语法/ " class="go-post">
        阅读全文
    </a>
</div>


             
<div class="page-current">

    <div class="prev">
        
    </div>

    <div class="page-index">

        

        <span class="current">
            1
        </span>

        
        <span>
            <a href="/page/2/">
                <span class="page-num">
                    2
                </span>
            </a>
            

            

        </span>
        

    </div>

    <div class="next">
        
        <a href="/page/2/ ">
            <span class="page-num">
                <a-icon type="caret-right" theme="filled" />
            </span>
        </a>
        
    </div>

</div>

        </div>
    </div>
    
    <div id="home-card">
        <a-affix :offset-top="card_top">
    <a-card class="card-style" style="width: 300px">
        <div class="avatar">
            <img src="images/src.jpeg " alt="头像">
        </div>
        <div class="name">
            小刘
        </div>
        <div class="descriptions">
            
            <div class="description">
                路漫漫其修远兮
            </div>
            
            <div class="description">
                吾将上下而求索
            </div>
            
        </div>
        <div class="icon-links">
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://github.com/dddwah11">

                    
                    <a-icon type="github"
                        theme="filled" />
                    
                </a>
            </span>
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://twitter.com/DDDwah">

                    
                    <a-icon type="twitter"
                        theme="" />
                    
                </a>
            </span>
            
        </div>
        <div class="friend-links">
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/">
                    Hexo主页
                </a>
            </div>
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://korilin.github.io/hexo-theme-particle-demo/full/public/">
                    主题作者
                </a>
            </div>
            
        </div>
    </a-card>
</a-affix>
    </div>
    
</div>
                     
<footer id="footer">
    <div class="footer-wrap">
        <div>
            © 2018 - 2022 61分
            <span class="footer-icon">
                <a-icon type="flag" theme="filled" /></span>
            @小刘
        </div>
        <div></div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo Engine</a> & <a
                target="_blank" rel="noopener" href="https://github.com/korilin/hexo-theme-particle">Particle Theme</a></div>
        
    </div>

</footer>

<script src="/js/highlight.min.js"></script>
<script src="/js/particle.js"></script>
                </div>
            </div>
        </transition>
    </div>

    <script>
    new Vue({
        el: "#layout",
        data: {
            show_page: false,
            onload_menu: false,
            menu_show: false,
            card_top: 100
        },
        created: function () {
            var that = this
            window.onload = function () {
                that.show_page = true
                document.getElementById("loadcontent").style.opacity = 0
                setTimeout(function () {
                    document.getElementById("loadleft").style.width = 0
                    document.getElementById("loadright").style.width = 0
                }, 300)
                setTimeout(function () {
                    document.getElementById("loading").style = "display:none"
                }, 600)
            }
        },
        mounted: function () {
            var that = this
            window.addEventListener('scroll', function (e) {
                that.menu_show = false
            })
        },
        methods: {
            home_click: function () {
                window.scrollTo({
                    top: window.innerHeight - 80,
                    behavior: "smooth",
                });
            }
        }
    })
</script>

</body>

</html>